const e=(...t)=>{let n=!1;"boolean"==typeof t[0]&&(n=t.shift());let s=t[0];if(!s||"object"!=typeof s)throw new Error("extendee must be an object");const o=t.slice(1),i=o.length;for(let t=0;t<i;t++){const i=o[t];for(let t in i)if(i.hasOwnProperty(t)){const o=i[t];if(n&&(Array.isArray(o)||"object"==typeof(l=o)&&null!==l&&l.constructor===Object&&"[object Object]"===Object.prototype.toString.call(l))){const n=Array.isArray(o)?[]:{};s[t]=e(!0,s.hasOwnProperty(t)?s[t]:n,o)}else s[t]=o}}var l;return s},t=(e,t=window.ConsentControl.cookieName||"privacyconsent")=>{var s=n()||[];e=Array.isArray(e)?e:[e];for(var o=0;o<e.length;o++){var i=e[o];-1===s.indexOf(i)?s.push(i):s.splice(i,1)}var l=window.location.hostname,c=new Date;c.setTime(c.getTime()+31536e6);var r="expires="+c.toUTCString();document.cookie=t+"="+e.join("|")+";"+r+";path=/;samesite=lax;domain="+l},n=e=>{let t=window.ConsentControl.cookieName||"privacyconsent";t+="=";const n=document.cookie.split(";");for(let s=0;s<n.length;s++){let o=n[s];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t)){const n=o.substring(t.length,o.length).split("|");return e?n.includes(e):n}}return!1},s=(e,t,n,s,o)=>{let i=e.options.template[t];return s&&(i=i.replace(/{\w+}/g,(e=>s[e.substring(1,e.length-1)]||e))),n&&(i=i.replace(/{\w+}/g,(e=>"{key}"==e?n:e))),o&&(i=i.replace(/{\w+}/g,(e=>o[e.substring(1,e.length-1)]||e))),i=i.replace(/{\w+}/g,(t=>e.options.template.strings[t.substring(1,t.length-1)]||t)),i},o={cookieName:"consentcontrol",parentEl:null,template:{strings:{mainTitle:"Cookies & Dienste",mainDescription:'Diese Webseite nutzt Cookies und externe Dienste.<br /><a\n         href="/datenschutz/">Datenschutzbestimmungen</a> <a href="/impressum/">Impressum</a>',settingsButtonLabel:"Weitere Informationen",resetButtonLabel:"Alle Cookies löschen",resetMessage:"Alle Cookies wurden erfolgreich gelöscht.",closeButtonLabel:"Schließen",okButtonLabel:"OK",allButtonLabel:"Alle erlauben"},main:'<div id="consent-control-banner" class="is-collapsed" aria-modal="true" aria-hidden="true" aria-label="{mainTitle}">\n         </div>',headerEl:"header",header:'<h3>{mainTitle}</h3>\n         <p>{mainDescription}</p>\n         <button class="collapsed-only consent-control--open">{settingsButtonLabel}</button>',switches:'<div class="switches"></div>',switch:'<div class="form-check form-switch">\n          <input id="consent-{key}" value="{key}" class="form-check-input" type="checkbox" role="switch">\n          <label for="consent-{key}" class="form-check-label">{label}</label>\n        </div>',switchChild:"<li>\n            <h4>{label}</h4>\n          </li>",footer:'\n         <div class="uncollapsed-only">\n             <button class="consent-control--reset">{resetButtonLabel}</button>\n         </div>\n         <div class="control">\n             <button class="secondary uncollapsed-only consent-control--close">{closeButtonLabel}</button>\n             <button id="consent-control--submit">{okButtonLabel}</button>\n             <button id="consent-control--submit-all">{allButtonLabel}</button>\n         </div>'},switches:{}};class i{constructor(t={}){this.options=e(!0,o,t),this.status=[],document.querySelectorAll(".consent-control--open").forEach((function(e){e.addEventListener("click",(e=>{e.preventDefault(),this.show()}))})),n()||this.show(),this.runServices()}show(){const e=n();this.El=document.getElementById("#consent-control-banner"),this.status.includes("initialized")||(this.El=this.initConsentControlBanner()),this.status.includes("events")||this.aliveConsentControlBanner(),e.length&&e.forEach((function(e){this.El.querySelectorAll("input[value="+e+"]").forEach((e=>{e.checked=!0}))})),this.El.classList.remove("hide")}initConsentControlBanner(){const e=this.options.parentEl||document.body;let t=e.querySelector("#consent-control-banner");t||(e.insertAdjacentHTML("beforeend",s(this,"main")),t=e.querySelector("#consent-control-banner")),this.options.animated&&t.classList.add("is-animated"),this.options.hideOnScroll&&t.classList.add("hide-on-scroll");let n=t.querySelector(".consent-control--open");if(!n){const e=document.createElement(this.options.template.headerEl);e.innerHTML=s(this,"header"),t.appendChild(e),n=e.querySelector(".consent-control--open")}let o=t.querySelector(".switches");if(!o){t.insertAdjacentHTML("beforeend",s(this,"switches")),o=t.querySelector(".switches");for(const[e,t]of Object.entries(this.options.switches)){o.insertAdjacentHTML("beforeend",s(this,"switch",e,t));const n=o.lastElementChild;if(t.description){const e=document.createElement("p");e.classList.add("description"),e.innerHTML=t.description,n.appendChild(e)}const i=n.querySelector("input");if(t.disabled&&i.setAttribute("disabled","disabled"),t.checked&&i.setAttribute("checked","checked"),t.childs){const e=document.createElement("ul");e.classList.add("childs"),n.appendChild(e);for(const[n,o]of Object.entries(t.childs)){e.insertAdjacentHTML("beforeend",s(this,"switchChild",!1,!1,o));const t=e.lastElementChild;if(o.description){const e=document.createElement("p");e.classList.add("description"),e.innerHTML=o.description,t.appendChild(e)}}}}}let i=t.querySelector("#consent-control--submit");return i||(t.insertAdjacentHTML("beforeend",s(this,"footer")),i=t.querySelector("#consent-control--submit")),document.documentElement.classList.add("with-consentControl"),this.status.push("initialized"),t}aliveConsentControlBanner(){this.El.querySelector("#consent-control--submit").addEventListener("click",(e=>{e.preventDefault();const n=[];this.El.querySelectorAll("input").forEach((e=>{e.checked&&n.push(e.value)})),t(n),this.El.classList.add("hide","is-collapsed"),this.runServices()})),this.El.querySelector("#consent-control--submit-all").addEventListener("click",(e=>{e.preventDefault();const n=[];this.El.querySelectorAll("input").forEach((e=>{n.push(e.value)})),t(n),this.El.classList.add("hide","is-collapsed"),this.runServices()})),this.El.querySelectorAll(".consent-control--close").forEach((function(e){e.addEventListener("click",(e=>{e.preventDefault(),this.El.classList.add("is-collapsed")}))})),this.El.querySelectorAll(".consent-control--open").forEach((function(e){e.addEventListener("click",(e=>{e.preventDefault(),this.El.classList.remove("is-collapsed")}))})),this.El.querySelectorAll(".consent-control--reset").forEach((function(e){e.addEventListener("click",(e=>{e.preventDefault(),deleteAllCookies()}))}))}runServices(){const e=n();e&&e.forEach((e=>{"function"==typeof this.options.switches[e].callback&&this.options.switches[e].callback()}))}}window.ConsentControl=new i;const l=(e,t)=>{var n,s,o;s=!1,(n=document.createElement("script")).type="text/javascript",n.src=e,n.onload=n.onreadystatechange=function(){s||this.readyState&&"complete"!=this.readyState||(s=!0,t())},(o=document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,o)},c={template:{strings:{message:'Diese Inhalte werden extern geladen von <i class="consent-message--source">{srcName}</i>.<br />Durch das Aktivieren dieses Inhalts werden Daten wie Ihre IP-Adresse an den externen Server übertragen. Weitere Informationen entnehmen Sie bitte unserer <a href="/datenschutz/" title="Datenschutzerklärung lesen">Datenschutzerklärung</a>.',buttonLabel:"Inhalte laden"},main:'<div class="consent-message"><button class="button confirm">{buttonLabel}</button><p>{message}</p></div>'}};window.ConsentMessage={callbacks:{}};const r=window.ConsentMessage,a=(t,o={},i,l,a=(()=>{i.setAttribute("src",i.getAttribute("data-src")),d(i)}))=>{if(r.options=e(!0,c,o),r.status=[],t&&n(t))return a(),void d(i);if(r.callbacks[i]=function(){a(),d(i)},!l){const e=i.getAttribute("data-src");l=i.getAttribute("data-src-name")??(e=>{const t=document.createElement("a");return t.href=e,t})(e).hostname}let u=i;r.options.template&&("IFRAME"===i.tagName&&(u=document.createElement("div"),u.classList.add("consent-message--wrapper"),i.parentNode.insertBefore(u,i),u.appendChild(i)),u.insertAdjacentHTML("afterbegin",s(r,"main").replace(/{\w+}/g,l))),u.querySelector("button.confirm").addEventListener("click",r.runConsentMessageCallback(t))};r.runConsentMessageCallback=e=>{console.log(e)},window.ConsentMessage=e(!0,window.ConsentMessage,a);const d=e=>{"IFRAME"===e.tagName&&(e=e.parentNode);const t=e.querySelector(".consent-message");t&&t.remove()};window.loadScript=l,window.getConsentControlCookie=n,window.ConsentControl=i;export{i as ConsentControl,a as ConsentMessage,n as getConsentControlCookie,l as loadScript};
